include(CheckCXXSourceCompiles)
include(CheckFunctionExists)
include(CheckIncludeFileCXX)

CHECK_FUNCTION_EXISTS(openat HAS_OPENAT)
CHECK_FUNCTION_EXISTS(unlinkat HAS_UNLINKAT)
CHECK_FUNCTION_EXISTS(mkdirat HAS_MKDIRAT)
CHECK_FUNCTION_EXISTS(renameat HAS_RENAMEAT)
CHECK_FUNCTION_EXISTS(fstatat HAS_FSTATAT)
CHECK_FUNCTION_EXISTS(fchmodat HAS_FCHMODAT)
CHECK_FUNCTION_EXISTS(futimens HAS_FUTIMENS)
CHECK_FUNCTION_EXISTS(readlinkat HAS_READLINKAT)
CHECK_FUNCTION_EXISTS(symlinkat HAS_SYMLINKAT)
CHECK_FUNCTION_EXISTS(linkat HAS_LINKAT)
CHECK_FUNCTION_EXISTS(clock_gettime HAS_CLOCK_GETTIME)

if (HAS_OPENAT AND HAS_UNLINKAT AND HAS_MKDIRAT AND HAS_RENAMEAT AND HAS_FSTATAT AND HAS_FCHMODAT AND HAS_RENAMEAT AND HAS_SYMLINKAT AND HAS_LINKAT)
    add_definitions(-DHAS_AT_FUNCTIONS)
endif ()

if (HAS_FUTIMENS)
    add_definitions(-DHAS_FUTIMENS)
endif ()

if (HAS_CLOCK_GETTIME)
    add_definitions(-DHAS_CLOCK_GETTIME)
endif ()
